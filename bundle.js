!function(e){var t={};function s(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){s(2),e.exports=s(1)},function(e,t,s){},function(e,t,s){"use strict";s.r(t);const n=new class{constructor(e){this.selector=e.selector,this.elements=e.elements}start(){this.init()}init(){document.querySelector(this.selector).innerHTML=this.elements}}({selector:"body",elements:'\n              <app-keyboard class="app-keyboard" id="app-keyboard">\n                  <textarea class="keyboard-print" id="keyboard-print" spellcheck="false"></textarea>\n              </app-keyboard>\n              <div class="info">\n                <span class="lang-info">Для переключения раскладки нажми Ctrl+Shift</span>\n                <span class="caps-block">Caps Lock: <span class="caps off">OFF</span>\n                <span class="lang">Language: EN</span>\n              </div>\n  '});class i{constructor(e){this.id=e.id}setActive(){document.querySelector(`.${this.id.toLowerCase()}`).classList.add("active")}removeActive(){document.querySelector(`.${this.id.toLowerCase()}`).classList.remove("active")}}class r extends i{constructor(e){super(e),this.ru=e.ru,this.en=e.en,this.langSaved=localStorage.getItem("language"),this.lang=this.langSaved?this[this.langSaved]:this.en,this.ctrl=!1,this.shift=!1,this.caps=!1,this.languageSwitch="en",[this.current]=this.langSaved?e[this.langSaved]:e.en,this.symbols=/[a-zа-яё]/i}inform(e,t){switch(e){case"Shift":{this.shift=t.shift;const e=this.lang[0];if(this.ctrl&&t.shift&&this.lang===this.en?(this.lang=this.ru,this.languageSwitch="ru",localStorage.setItem("language","ru")):this.ctrl&&t.shift&&this.lang===this.ru&&(this.lang=this.en,this.languageSwitch="en",localStorage.setItem("language","en")),t.shift&&this.caps){if(!this.symbols.test(String.fromCodePoint(e)))return void(this.current=this.lang[1]);this.current=this.lang[0]}else if(!t.shift&&this.caps){if(!this.symbols.test(String.fromCodePoint(e)))return void(this.current=this.lang[0]);this.current=this.lang[1]}else t.shift&&!t.caps?this.current=this.lang[1]:this.current=this.lang[0];break}case"CapsLock":if(this.caps=t.caps,t.caps){const e=this.lang[0];if(!this.symbols.test(String.fromCodePoint(e)))return;this.current=this.lang[1]}else this.current=this.lang[0];break;case"Ctrl":{const e=this.lang[0];if(t.ctrl&&this.shift&&this.lang===this.en?(this.lang=this.ru,this.languageSwitch="ru",localStorage.setItem("language","ru")):t.ctrl&&this.shift&&this.lang===this.ru&&(this.lang=this.en,this.languageSwitch="en",localStorage.setItem("language","en")),this.shift&&this.caps){if(!this.symbols.test(String.fromCodePoint(e)))return void(this.current=this.lang[1]);this.current=this.lang[0]}this.shift&&!this.caps&&(this.current=this.lang[1]),this.ctrl=t.ctrl;break}}}}const o={row1:{Backquote:[[96,126],[1105,1025]],Digit1:[[49,33],[49,33]],Digit2:[[50,64],[50,34]],Digit3:[[51,35],[51,8470]],Digit4:[[52,36],[52,59]],Digit5:[[53,37],[53,37]],Digit6:[[54,94],[54,58]],Digit7:[[55,38],[55,63]],Digit8:[[56,42],[56,42]],Digit9:[[57,40],[57,40]],Digit0:[[48,41],[48,41]],Minus:[[45,95],[45,95]],Equal:[[61,43],[61,43]]},row2:{KeyQ:[[113,81],[1081,1049]],KeyW:[[119,87],[1094,1062]],KeyE:[[101,69],[1091,1059]],KeyR:[[114,82],[1082,1050]],KeyT:[[116,84],[1077,1045]],KeyY:[[121,89],[1085,1053]],KeyU:[[117,85],[1075,1043]],KeyI:[[105,73],[1096,1064]],KeyO:[[111,79],[1097,1065]],KeyP:[[112,80],[1079,1047]],BracketLeft:[[91,123],[1093,1061]],BracketRight:[[93,125],[1098,1066]],Backslash:[[92,124],[92,47]]},row3:{KeyA:[[97,65],[1092,1060]],KeyS:[[115,83],[1099,1067]],KeyD:[[100,68],[1074,1042]],KeyF:[[102,70],[1072,1040]],KeyG:[[103,71],[1087,1055]],KeyH:[[104,72],[1088,1056]],KeyJ:[[106,74],[1086,1054]],KeyK:[[107,75],[1083,1051]],KeyL:[[108,76],[1076,1044]],Semicolon:[[59,58],[1078,1046]],Quote:[[39,34],[1101,1069]]},row4:{KeyZ:[[122,90],[1103,1071]],KeyX:[[120,88],[1095,1063]],KeyC:[[99,67],[1089,1057]],KeyV:[[118,86],[1084,1052]],KeyB:[[98,66],[1080,1048]],KeyN:[[110,78],[1090,1058]],KeyM:[[109,77],[1100,1068]],Comma:[[44,60],[1073,1041]],Period:[[46,62],[1102,1070]],Slash:[[47,63],[46,44]]}},a={row1:[],row2:[],row3:[],row4:[]};Object.keys(a).forEach(e=>{Object.entries(o[e]).forEach(t=>{a[e].push(new r({id:t[0],en:t[1][0],ru:t[1][1]}))})});class c extends i{constructor(e){super(e),this.name=e.name,this.shift=!1,this.caps=!1,this.ctrl=!1,this.observers=[]}notify(){this.observers.forEach(e=>e.inform(this.name,this))}keyDown(){"CapsLock"===this.id?this.caps=!this.caps:"Ctrl"===this.name?this.ctrl=!0:this.shift=!0,this.notify()}keyUp(){"Ctrl"===this.name?this.ctrl=!1:this.shift=!1,this.notify()}register(e){this.observers.push(e)}}const h={row1:{Backspace:"Backspace"},row2:{Tab:"Tab",Delete:"Del"},row3:{CapsLock:"CapsLock",Enter:"Enter"},row4:{ShiftLeft:"Shift",ArrowUp:"↑",ShiftRight:"Shift"},row5:{ControlLeft:"Ctrl",Win:"Win",AltLeft:"Alt",Space:" ",AltRight:"Alt",ArrowLeft:"←",ArrowDown:"↓",ArrowRight:"→",ControlRight:"Ctrl"}},d={row1:[],row2:[],row3:[],row4:[],row5:[]};Object.keys(d).forEach(e=>{Object.entries(h[e]).forEach(t=>{d[e].push(new c({id:t[0],name:t[1]}))})});({list:[n,new class{constructor(){this.createNodes=e=>{const t=document.createElement("input");return t.name=e.id,t.value=String.fromCodePoint(e.current),t.type="button",t.classList=`button ${e.id.toLowerCase()}`,t},this.createServices=(e,t,s)=>{e.insertAdjacentHTML(s,`\n       <input name="${t.id}" type="button" value="${t.name}" class="button ${t.id.toLowerCase()}">`)},this.createServicesNodes=e=>{const t=document.createElement("input");return t.name=e.id,t.value=e.name,t.type="button",t.classList=`button ${e.id.toLowerCase()}`,t},this.servicesKeys=Object.values(d).flat(),this.alphaDigKeys=Object.values(a).flat(),this.allButtons=[...this.servicesKeys,...this.alphaDigKeys],this.alphaDigitNodes=[],this.nodesData=()=>{const e={};return this.alphaDigKeys.forEach(t=>{e[t.id]=t}),e}}start(){this.init(),this.pressKey(),this.upKey(),this.setObserve(),this.onclick(),this.onload(),this.onBlurShift()}init(){const e=document.querySelector("#app-keyboard");this.render(e),this.addServices(e);const t=document.querySelector("#keyboard-print");t.onkeypress=()=>!1,t.onkeydown=()=>!1,t.onblur=()=>t.focus()}render(e){const t=document.createElement("div");t.classList.add("keyboard"),t.setAttribute("id","keyboard"),Object.keys(a).forEach(s=>{const n=a[s].map(this.createNodes),i=document.createElement("div");i.classList.add("row"),i.append(...n),t.append(i),e.append(t),this.alphaDigitNodes=this.alphaDigitNodes.concat(n)})}addServices(e){const t=e.getElementsByTagName("div"),s=e.querySelector(".keyboard");this.createServices(t[1],d.row1[0],"beforeend"),this.createServices(t[2],d.row2[0],"afterbegin"),this.createServices(t[2],d.row2[1],"beforeend"),this.createServices(t[3],d.row3[0],"afterbegin"),this.createServices(t[3],d.row3[1],"beforeend"),this.createServices(t[4],d.row4[0],"afterbegin"),this.createServices(t[4],d.row4[1],"beforeend"),this.createServices(t[4],d.row4[2],"beforeend");const n=d.row5.map(this.createServicesNodes),i=document.createElement("div");i.classList.add("row"),i.append(...n),s.append(i)}pressKey(){document.addEventListener("keydown",e=>{const t=this.alphaDigKeys.find(t=>t.id===e.code);if(t){const e=String.fromCodePoint(t.current);if(t.ctrl)return;this.changeInput(e)}const s=this.allButtons.find(t=>t.id===e.code);s&&s.setActive()})}upKey(){document.addEventListener("keyup",e=>{const t=this.allButtons.find(t=>t.id===e.code);t&&t.removeActive()})}setObserve(){const e=/CapsLock|ShiftLeft|ShiftRight|ControlLeft|ControlRight/i,t=this.servicesKeys.filter(t=>e.test(t.id));this.alphaDigKeys.forEach(e=>t.forEach(t=>t.register(e))),this.handleServicesBtn(t)}update(){const e=this.nodesData();this.alphaDigitNodes.forEach(t=>{t.value=String.fromCodePoint(e[t.name].current)})}handleServicesBtn(e){const t=t=>{const{type:s,code:n}=t;"Space"!==n||"keydown"!==s?"Delete"!==n||"keydown"!==s?"Enter"!==n||"keydown"!==s?"Backspace"!==n||"keydown"!==s?"ArrowLeft"!==n||"keydown"!==s?"ArrowRight"!==n||"keydown"!==s?"ArrowUp"!==n||"keydown"!==s?"ArrowDown"!==n||"keydown"!==s?"Tab"!==n||"keydown"!==s?e.forEach(e=>{if(n===e.id)if("Shift"===e.name)"keydown"===s?e.keyDown():e.keyUp(),this.renderLanguage(),this.update();else if("CapsLock"===e.name){if("keydown"!==s)return;e.keyDown(),this.update(),this.capsSwitch(e.caps)}else"Ctrl"===e.name&&("keydown"===s?e.keyDown():e.keyUp(),this.renderLanguage(),this.update())}):this.changeInput("tab"):this.arrow("down"):this.arrow("up"):this.arrow("right"):this.arrow("left"):this.changeInput("backspace"):this.changeInput("enter"):this.changeInput("delete"):this.changeInput(" ")};document.addEventListener("keydown",t),document.addEventListener("keyup",t)}onclick(){const e=document.getElementById("keyboard"),t=this.servicesKeys.find(e=>"CapsLock"===e.id),s=this.servicesKeys.find(e=>"ShiftLeft"===e.id),n=this.servicesKeys.find(e=>"ControlLeft"===e.id),i=e=>{const{type:i}=e,r=e.target;if("INPUT"!==r.tagName)return;const{value:o,name:a}=r;if("Del"!==o||"mousedown"!==i)if("Backspace"!==o||"mousedown"!==i){if("Enter"!==o||"mousedown"!==i)return"CapsLock"===o&&"mousedown"===i?(t.keyDown(),this.update(),void this.capsSwitch(t.caps)):"Shift"===o?("mousedown"===i?s.keyDown():s.keyUp(),this.update(),void this.renderLanguage()):"Ctrl"===o?("mousedown"===i?n.keyDown():n.keyUp(),this.renderLanguage(),void this.update()):void("ArrowLeft"!==a||"mousedown"!==i?"ArrowRight"!==a||"mousedown"!==i?"ArrowUp"!==a||"mousedown"!==i?"ArrowDown"!==a||"mousedown"!==i?"Tab"!==a||"mousedown"!==i?"mouseup"!==i&&(/^[←↓→↑]|.{2,}$/i.test(o)||this.changeInput(o)):this.changeInput("tab"):this.arrow("down"):this.arrow("up"):this.arrow("right"):this.arrow("left"));this.changeInput("enter")}else this.changeInput("backspace");else this.changeInput("delete")};e.addEventListener("mousedown",i),e.addEventListener("mouseup",i)}onBlurShift(){document.querySelector("#keyboard div:nth-child(4)").addEventListener("mouseout",e=>{const{target:t}=e;t&&"INPUT"===t.tagName&&"Shift"===t.value&&(this.servicesKeys.find(e=>"ShiftLeft"===e.id).keyUp(),this.update())})}changeInput(e){const t=document.querySelector("#keyboard-print");let s=t.selectionStart,n=t.selectionEnd;return"delete"===e?(s<t.value.length&&s===n&&n++,void t.setRangeText("",s,n,"end")):"backspace"===e?(s>0&&s===n&&s--,void t.setRangeText("",s,n,"end")):void("enter"!==e?"tab"!==e?(t.setRangeText(e,s,n,"end"),t.focus()):t.setRangeText("\t",s,n,"end"):t.setRangeText("\n",s,n,"end"))}arrow(e){const t=document.querySelector("#keyboard-print");let s=t.selectionStart,n=t.selectionEnd;const i=()=>{const e=t.value.split("\n").map(e=>e.length+1);let n=0,i=0;return e.reduce((e,t,r)=>(s>=e&&(i=s-e,n=r),t+e),0),{linesLength:e,idx:n,pos:i}};switch(e){case"left":s>0&&s===n&&(t.selectionEnd=--s),s>0&&s!==n&&(t.selectionEnd=s);break;case"right":s<t.value.length&&s===n&&(t.selectionStart=++n),s<t.value.length&&s!==n&&(t.selectionStart=n);break;case"up":{const{linesLength:e,idx:n,pos:r}=i();if(n<=0)return;const o=e[n-1],a=1===o?s-r-1:s-o;t.selectionEnd=r>=o?s-r-1:a;break}case"down":{const{linesLength:e,idx:n,pos:r}=i();if(n>=e.length-1)return;const o=e[n+1],a=e[n],c=1===o?s+e[n]-r:s+e[n];t.selectionStart=r>=o?s-r+o+a-1:c}}}capsSwitch(e){const t=document.querySelector(".caps");e?(t.innerHTML="ON",t.classList.add("on")):(t.innerHTML="OFF",t.classList.remove("on"))}languageSwitch(e){const t=document.querySelector(".lang");t.innerHTML=e?"Language: EN":"Language: RU"}renderLanguage(){let e=localStorage.getItem("language");e=!e||"en"===e,this.languageSwitch(e)}onload(){document.addEventListener("DOMContentLoaded",this.renderLanguage.bind(this)),document.addEventListener("DOMContentLoaded",()=>{document.querySelector("#keyboard-print").focus()})}}]}).list.forEach(e=>{(e=>{e.start()})(e)})}]);